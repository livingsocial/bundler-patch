language: ruby

before_install:
  - echo $GEM_PATH
  - gem list bundler -d
  - for dir in $(echo $GEM_PATH | tr ':' ' '); do gem uninstall -i $dir bundler -a -x; done
  - gem install bundler -v $BUNDLER_TEST_VERSION
  - bundle --version
#  - rvm use 2.1.10 --install --binary --fuzzy
#  - gem update --system
  - rvm use $RVM_VER --install --binary --fuzzy
  - gem update --system # this is blowing up now?

script: bundle exec rake test:all

matrix:
  include:
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.9.10
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.10.5
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.11.2
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.12.5
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.13.6
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.14.6
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.15.4
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.16.6
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=1.17.3
      - BP_DEBUG=1
    - rvm: 2.4.5
      env:
      - RVM_VER=2.4.5
      - BUNDLER_TEST_VERSION=1.17.3
      - BP_DEBUG=1
    - rvm: 2.3.8
      env:
      - RVM_VER=2.3.8
      - BUNDLER_TEST_VERSION=1.17.3
      - BP_DEBUG=1
    - rvm: 2.6.0
      env:
      - RVM_VER=2.6.0
      - BUNDLER_TEST_VERSION=1.17.3
      - BP_DEBUG=1
    - rvm: 2.5.3
      env:
      - RVM_VER=2.5.3
      - BUNDLER_TEST_VERSION=2.0.1
      - BP_DEBUG=1
